---
layout: post
title: iOS直播app个人实践--推流篇
date: 2015-12-31 15:32:24.000000000 +09:00
tags: [LiveVideo , Video , Auido , TransferProtocol]
---

如果不了解原理，可以看这篇文章[iOS直播app个人实践--原理篇](http://garfieldlover.github.io/2015/12/iOS%E7%9B%B4%E6%92%ADapp%E4%B8%AA%E4%BA%BA%E5%AE%9E%E8%B7%B5-%E5%8E%9F%E7%90%86%E7%AF%87)。

开发一款直播app，需要流媒体服务器，本篇主要讲解直播中流媒体服务器搭建，下边介绍常用功能。

## 一、nginx
nginx是非常优秀的HTTP开源服务器，其特点是占有内存少，并发能力强，用它来做hls或者rtmp流媒体服务器是非常不错的选择。
#### 1.1、安装Homebrow
查看是否已经安装

```
man brew
```
执行安装命令

```
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
```
卸载
```
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/uninstall)"
```
#### 1.2、安装nginx
先clone nginx项目到本地：

```
brew tap homebrew/nginx
```
执行安装：

```
brew install nginx-full --with-rtmp-module
```
nginx安装位置

```
brew info nginx-full
```
nginx安装所在位置

```
/usr/local/Cellar/nginx-full/1.10.1/bin/nginx
```
nginx配置文件所在位置

```
/usr/local/etc/nginx/nginx.conf
```
#### 1.3、运行nginx
执行命令 ，测试下是否能成功启动nginx服务

```
nginx
```

在浏览器地址栏输入：[http://localhost:8080](http://localhost:8080)
如果出现,代表nginx安装成功了

![nginx](https://raw.githubusercontent.com/GarfieldLover/GarfieldLover.github.io/master/assets/postImages/2004362-ca10e04901ad2b45.png)


如果终端上提示,则表示8080端口被占用了

```
nginx: [emerg] bind() to 0.0.0.0:8080 failed (48: Address already in use)
```
查看8080端口PID

```
lsof -i tcp:8080
```
kill掉占用8080端口的PID,然后重新执行nginx

```
kill 9603（这里替换成占用8080端口的PID）
```
重新加载配置文件

```
nginx -s reload
```

停止 nginx

```
nginx -s stop
```

有序退出 nginx

```
nginx -s quit
```
#### 1.4、配置rtmp


